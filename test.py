import streamlit as st

# 페이지 설정
st.set_page_config(
    page_title="쫄깃쩔깃돌멩이님의 응급 처치 종합 가이드",
    layout="wide",
    initial_sidebar_state="expanded"
)

# --- 응급 처치 정보 데이터 (업데이트) ---
first_aid_data = {
    "찰과상": {
        "제목": "찰과상 (긁힌 상처) 응급 처치",
        "설명": "피부 표면이 긁히거나 벗겨진 상처입니다. 대부분 경미하지만, 감염 예방이 중요합니다.",
        "처치법": """
        1.  **상처 부위 확인 및 세척**: 깨끗한 흐르는 물과 비누로 상처 부위를 부드럽게 씻어냅니다. 흙이나 이물질이 있다면 완전히 제거해야 합니다. [【1】](https://www.wonju.go.kr/health/contents.do?key=1690&)
        2.  **지혈**: 소독된 거즈나 깨끗한 천으로 상처 부위를 가볍게 압박하여 출혈을 멈춥니다.
        3.  **소독**: 소독약을 바르거나 항생제 연고를 얇게 바릅니다. 알레르기 반응에 주의하세요.
        4.  **상처 덮기**: 감염을 막기 위해 멸균 거즈나 밴드로 상처를 덮어줍니다. 통풍이 잘 되게 해주고, 너무 세게 조이지 않도록 합니다.
        5.  **의료기관 방문**: 상처가 깊거나 오염이 심한 경우, 출혈이 멈추지 않거나 감염 징후(부어오름, 통증, 고름 등)가 보이면 즉시 의료기관을 방문해야 합니다. [【1】](https://www.wonju.go.kr/health/contents.do?key=1690&)
        """,
        "키워드": ["긁힘", "벗겨짐", "피부 상처", "쓸림", "찰과상"]
    },
    "화상": {
        "제목": "화상 응급 처치",
        "설명": "뜨거운 물, 불, 전기, 화학 물질 등으로 인해 피부 조직이 손상된 상태입니다. 화상 정도에 따라 처치법이 달라지며, 신속한 초기 대응이 중요합니다.",
        "처치법": """
        1.  **신속한 냉각**: 화상 부위를 즉시 찬물(수도꼭지 물이 아닌, 미지근한 정도의 차가운 물)에 15-20분 정도 담그거나 흐르는 물로 식혀줍니다. 얼음은 사용하지 마세요.
        2.  **옷, 장신구 제거**: 물집이 생기기 전이나 붓기 전에 화상 부위의 옷이나 반지, 시계 등 장신구를 조심스럽게 제거합니다. 옷이 피부에 붙었다면 억지로 떼어내지 마세요.
        3.  **물집은 터뜨리지 않기**: 물집은 감염을 막아주는 보호막 역할을 합니다. 절대로 터뜨리지 마세요.
        4.  **깨끗한 거즈로 덮기**: 화상 부위를 깨끗하고 소독된 거즈나 천으로 느슨하게 덮어줍니다. 연고나 다른 물질을 바르지 마세요.
        5.  **병원 방문**: 화상 부위가 넓거나 깊은 경우(2도 이상의 화상), 얼굴, 손, 발, 생식기 등 중요 부위에 화상을 입었을 경우 즉시 병원(화상 전문 병원 또는 응급실)으로 가야 합니다. 특히 전기 화상은 인대, 근육 손상이 동반될 수 있으므로 반드시 의료기관의 진찰을 받아야 합니다.
        """,
        "키워드": ["뜨거움", "불", "뜨거운 물", "전기", "열", "화상"]
    },
    "베인 상처": {
        "제목": "베인 상처 (열상) 응급 처치",
        "설명": "날카로운 물체에 의해 피부나 조직이 깊게 손상된 상처입니다. 출혈이 심할 수 있으며 감염 위험이 있습니다.",
        "처치법": """
        1.  **출혈 확인 및 지혈**: 상처 부위에 직접 깨끗한 거즈나 천을 대고 강하게 압박하여 지혈합니다. [【10】](https://www.daejeon.go.kr/dj119/CmmContentsHtmlView.do?menuSeq=4368) 상처 부위를 심장보다 높게 들어 올리면 도움이 됩니다.
        2.  **상처 세척**: 출혈이 멈추면 깨끗한 흐르는 물이나 생리식염수로 상처 부위를 부드럽게 세척합니다. 이물질이 있다면 조심스럽게 제거합니다.
        3.  **소독 및 연고**: 상처 주위를 소독하고, 필요에 따라 항생제 연고를 바릅니다.
        4.  **상처 덮기**: 멸균 거즈나 밴드로 상처를 덮어 감염을 예방합니다.
        5.  **의료기관 방문**: 출혈이 심하거나, 상처가 깊어서 봉합이 필요한 경우, 이물질이 깊이 박힌 경우, 오염이 심한 경우(예: 녹슨 것에 베인 경우 파상풍 위험), 감염 징후가 보이는 경우 즉시 병원에 방문하여 의사의 진찰을 받아야 합니다.
        """,
        "키워드": ["칼", "깊은 상처", "피", "찢어짐", "베임"]
    },
    "골절": {
        "제목": "골절 응급 처치",
        "설명": "뼈가 부러지거나 금이 간 상태입니다. 극심한 통증과 함께 변형, 부종, 출혈 등이 동반될 수 있으며, 환자를 함부로 움직이면 더 큰 손상으로 이어질 수 있습니다.",
        "처치법": """
        1.  **움직이지 않게 하기**: 골절이 의심되는 부위를 절대로 함부로 움직이거나 건드리지 않습니다. [【2】](https://www.law.go.kr/flDownload.do?flSeq=26370406&flNm=%5B%EB%B3%84%ED%91%9C+5%5D+%EC%97%B0%EA%B5%AC%EC%8B%A4+%EC%82%AC%EA%B3%A0%EB%B0%9C%EC%83%9D+%EC%8B%9C+%EB%8C%80%EC%B2%98%EC%9A%94%EB%A0%B9) 부목이나 단단한 물건으로 지지하여 환부를 고정시키는 것이 중요합니다.
        2.  **출혈 관리**: 외출혈이 있다면 깨끗한 거즈나 천으로 직접 압박하여 지혈합니다.
        3.  **냉찜질**: 통증과 부종을 완화하기 위해 부러진 부위에 얼음 주머니를 대줍니다. (얼음이 피부에 직접 닿지 않도록 천으로 감싸주세요.)
        4.  **의료기관으로 이송**: 가능한 한 빨리 의료기관으로 이송해야 합니다. 구급차를 부르거나, 환자를 안전하게 고정시킨 상태로 이송해야 합니다. 환자를 옮길 때에는 부러진 뼈끝이 신경이나 혈관, 근육을 손상시키거나 피부를 뚫지 않도록 주의합니다. [【2】](https://www.law.go.kr/flDownload.do?flSeq=26370406&flNm=%5B%EB%B3%84%ED%91%9C+5%5D+%EC%97%B0%EA%B5%AC%EC%8B%A4+%EC%82%AC%EA%B3%A0%EB%B0%9C%EC%83%9D+%EC%8B%9C+%EB%8C%80%EC%B2%98%EC%9A%94%EB%A0%B9)
        """,
        "키워드": ["뼈", "부러짐", "금", "골절", "다리", "팔", "통증"]
    },
    "심장마비": {
        "제목": "심장마비 (심정지) 응급 처치 및 심폐소생술 (CPR)",
        "설명": "심장이 멈춰 혈액순환이 안 되는 위급한 상황입니다. 뇌 손상이 빠르게 진행될 수 있으므로, 즉각적인 심폐소생술이 생명을 살리는 데 결정적인 역할을 합니다.",
        "처치법": """
        1.  **반응 확인 및 119 신고**: 환자의 어깨를 두드리며 "괜찮으세요?" 하고 물어보고 반응이 없으면, 즉시 119에 신고하거나 주변 사람에게 신고를 요청합니다. 주변에 자동심장충격기(AED)가 있다면 가져다 줄 것을 요청합니다.
        2.  **기도 개방 및 호흡 확인**: 머리를 뒤로 젖히고 턱을 들어 올려 기도를 개방한 후, 환자의 가슴과 배를 보며 10초 이내로 호흡이 있는지 확인합니다. 의식 및 호흡이 없다면 심장마비를 의심해야 합니다. [【4】](https://www.icbp.go.kr/main/bbs/bbsMsgDetail.do?msg_seq=1789&bcd=safety&pgno=25) [【7】](https://www.icbp.go.kr/main/bbs/bbsMsgDetail.do?msg_seq=1929&bcd=safety&pgno=11)
        3.  **가슴 압박**: 심폐소생술은 심장마비 발생 시 인공적으로 혈액을 순환시키는 응급처치법입니다. [【5】](https://vod.kehrd.com/2210/docs/data/092.pdf) 환자의 가슴 중앙 흉골의 아래 1/2 지점에 손바닥을 대고, 양팔을 쭉 편 상태에서 체중을 실어 환자의 몸과 수직이 되도록 5~6cm 깊이로 강하고 빠르게(분당 100~120회 속도) 30회 압박합니다. [【9】](https://www.e-gen.or.kr/egen/first_aid_basics.do?contentsno=17)
        4.  **인공 호흡 (선택 사항)**: 가슴 압박 30회 후 인공 호흡 2회를 실시합니다. 코를 막고 환자의 입에 구조자의 입을 완전히 밀착하여 약 1초 동안 숨을 불어넣습니다. 인공호흡이 어렵다면 가슴 압박만 지속적으로 시행해도 됩니다. [【9】](https://www.e-gen.or.kr/egen/first_aid_basics.do?contentsno=17)
        5.  **반복**: 30회 가슴 압박과 2회 인공 호흡을 반복하거나, 119 구급대원이 현장에 도착할 때까지 또는 환자가 회복될 때까지 지속합니다.
        6.  **AED 사용**: AED가 준비되면 지시에 따라 적용하고 사용합니다.
        """,
        "키워드": ["심장", "호흡", "의식 없음", "쓰러짐", "CPR", "심정지", "쓰러짐", "쇼크", "가슴 압박"]
    },
    "코피": {
        "제목": "코피 응급 처치",
        "설명": "코 안의 혈관이 터지면서 피가 나는 증상입니다. 대부분은 스스로 멈추지만, 올바른 지혈법을 알아두는 것이 좋습니다.",
        "처치법": """
        1.  **가볍게 머리를 숙인다**: 고개를 뒤로 젖히면 피가 기도를 막거나 삼켜서 구토, 설사가 동반될 수 있으므로, 앞으로 살짝 숙여 피가 자연스럽게 흘러내리도록 합니다. [【8】](https://blog.naver.com/mykbsmc2780/223218518641?viewType=pc)
        2.  **콧잔등 압박**: 콧등의 단단한 뼈 아랫부분, 즉 콧방울의 말랑한 부분을 엄지와 검지로 지긋이 약 10분 정도 눌러줍니다. [【8】](https://blog.naver.com/mykbsmc2780/223218518641?viewType=pc)
        3.  **얼음찜질**: 콧잔등이나 코 주변에 얼음주머니를 대면 혈관을 수축시켜 지혈에 도움을 줄 수 있습니다. [【8】](https://blog.naver.com/mykbsmc2780/223218518641?viewType=pc)
        4.  **휴식**: 지혈 후에는 코를 만지거나 풀지 않고 잠시 휴식을 취합니다.
        5.  **의료기관 방문**: 30분 이상 코피가 멈추지 않거나, 코피가 너무 자주 나고 양이 많을 경우, 또는 다른 질환(고혈압 등)과 관련되어 의심될 경우 병원을 방문해야 합니다. [【8】](https://blog.naver.com/mykbsmc2780/223218518641?viewType=pc)
        """,
        "키워드": ["코피", "코", "출혈", "코 막힘"]
    },
     "일사병": {
        "제목": "일사병 (열사병 아님) 응급 처치",
        "설명": "더운 환경에서 장시간 활동하여 발생하는 열 손상 중 가장 흔한 형태입니다. 어지러움, 두통, 메스꺼움, 경련 등의 증상이 나타날 수 있습니다.",
        "처치법": """
        1.  **시원한 장소로 이동**: 환자를 즉시 시원한 그늘이나 에어컨이 있는 실내로 옮깁니다.
        2.  **옷 느슨하게 하기**: 환자의 옷을 느슨하게 풀어주거나 벗겨서 체온을 낮추기 쉽게 합니다.
        3.  **체온 냉각**: 부채질을 해주거나 찬 물수건으로 몸을 닦아주어 체온을 낮춥니다.
        4.  **수분 보충**: 의식이 있는 환자에게는 이온음료나 물을 마시게 하여 수분을 보충합니다. 단, 의식이 없다면 입으로 아무것도 주지 않아야 합니다. [【6】](https://www.safekorea.go.kr/idsiSFK/neo/sfk/cs/contents/prevent/SDIJK14433.html?cd1=33&cd2=99&pagecd=SDIJK144.33&menuSeq=128)
        5.  **병원 방문**: 시원한 곳에서 안정을 취한 후에도 증상이 호전되지 않거나, 의식이 없는 경우, 또는 열사병이 의심되는 경우(피부가 뜨겁고 건조하며 의식 변화가 심한 경우) 즉시 의료기관을 방문해야 합니다. [【6】](https://www.safekorea.go.kr/idsiSFK/neo/sfk/cs/contents/prevent/SDIJK14433.html?cd1=33&cd2=99&pagecd=SDIJK144.33&menuSeq=128)
        """,
        "키워드": ["더위", "열", "쓰러짐", "어지러움", "두통", "일사병"]
    }
}

# --- 사이드바 및 메인 타이틀 ---
st.sidebar.title("🩺 응급 처치 종합 가이드")
st.sidebar.markdown("다양한 사고와 증상에 대한 올바른 응급 처치 방법을 알아보세요.")

# 검색 기능
search_query = st.sidebar.text_input("🔍 특정 증상/사고 검색", placeholder="예: 화상, 골절, CPR, 코피", help="궁금한 응급 처치 관련 키워드를 입력해보세요.")

# 주요 상처 유형 선택
selected_type = st.sidebar.selectbox(
    "혹은 🌟 주요 상처 유형 선택",
    ["소개"] + list(first_aid_data.keys()),
    index=0 # '소개'가 기본 선택
)

st.title("🏥 일상생활 응급 처치 안내 웹사이트")
st.markdown("---")

# --- 내용 표시 로직 ---
if search_query:
    st.subheader(f"🔍 '{search_query}' 검색 결과")
    found_results = False
    
    # 검색어를 소문자로 변환하여 일관된 검색
    search_query_lower = search_query.lower()

    for key, value in first_aid_data.items():
        # 제목 또는 키워드에서 검색어 일치 여부 확인
        if search_query_lower in key.lower() or any(search_query_lower in k.lower() for k in value["키워드"]):
            with st.expander(f"✨ **{value['제목']}**", expanded=True): # 검색 결과는 바로 펼쳐서 보여줍니다.
                st.markdown(f"**상황 설명**: {value['설명']}")
                st.markdown("---")
                st.markdown("**응급 처치법**")
                st.markdown(value['처치법'])
            st.markdown("---") # 각 항목 아래 구분선 추가
            found_results = True
    if not found_results:
        st.warning(f"죄송합니다, '{search_query}'에 대한 응급 처치 정보를 찾을 수 없습니다. 😥")
        st.info("다른 키워드로 검색하거나, 좌측에서 주요 상처 유형을 선택해보세요.")
elif selected_type == "소개":
    st.subheader("안녕하세요,응급 처치 종합 가이드입니다! 👋")
    st.markdown("""
    이 웹사이트는 일상생활에서 발생할 수 있는 다양한 응급 상황에 대비하여, 신속하고 올바른 응급 처치 정보를 제공합니다.
    갑작스러운 사고가 발생했을 때 당황하지 않고 대처할 수 있도록, 핵심 정보를 알기 쉽게 정리했습니다.

    ---
    ### **이용 방법**
    1.  **좌측 사이드바에서 🌟 주요 상처 유형을 선택**: '찰과상', '화상', '골절', '심장마비' 등 주요 사고 유형을 클릭하여 해당 처치법을 바로 확인하세요.
    2.  **'🔍 특정 증상/사고 검색'에 키워드 입력**: 찾고 싶은 응급 처치와 관련된 단어(예: '불', '뼈', 'CPR', '코피')를 입력하여 빠르게 검색할 수 있습니다.

    ---
    ### **⚠️ 알림**
    제공되는 모든 정보는 **일반적인 초기 응급 처치 안내**입니다. 상처의 정도가 심하거나, 출혈이 멈추지 않거나, 통증이 극심한 경우 등 전문가의 진단과 치료가 반드시 필요한 상황에서는 지체 없이 **의료기관에 방문**해주세요. 필요 시 **119에 신고**하세요.
    """)

else: # 특정 유형이 선택되었을 때
    info = first_aid_data[selected_type]
    # st.expander를 기본적으로 펼쳐진 상태로 설정
    with st.expander(f"✨ **{info['제목']}**", expanded=True):
        st.markdown(f"**상황 설명**: {info['설명']}")
        st.markdown("---")
        st.markdown("**응급 처치법**")
        st.markdown(info['처치법'])
    st.markdown("---") # 항목 아래 구분선 추가

# CSS 스타일 (선택 사항) - 가독성을 위한 패딩 조정
st.markdown("""
<style>
    .reportview-container .main .block-container{
        padding-top: 2rem;
        padding-right: 5rem;
        padding-left: 5rem;
        padding-bottom: 2rem;
    }
    .css-1d391kg { /* sidebar padding */
        padding-top: 3.5rem;
        padding-right: 1rem;
        padding-left: 1rem;
        padding-bottom: 3.5rem;
    }
</style>
""", unsafe_allow_html=True)

# 푸터 (선택 사항)
st.sidebar.markdown("---")
st.sidebar.info("본 웹사이트의 내용은 정보 제공을 목적으로 하며, 전문적인 의료 조언을 대체할 수 없습니다. 🚨")
